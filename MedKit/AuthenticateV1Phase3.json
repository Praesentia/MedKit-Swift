{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "title"  : "Authenticate V1, Phase 3 Arguments",
    "type"   : "object",
    
    "properties" : {
        "principal" : { "$ref" : "#/definitions/Principal" }
        "key"       : { "type" : "string", "format" : "base64" }
    },
    
    "required" : [ "credentials", "key" ],
    "additionalProperties" : false,
    
    "definitions" : {
        "Principal" : {
            "type"  : "object",
            "properties" : {
                "identity"    : { "type" : "string" },
                "credentials" : { "$ref" : "#/definitions/Credentials" }
            }
            "requiredProperties"   : [ "identity", "credentials" ],
            "additionalProperties" : false
        },
        
        "Credentials" : {
            "type"  : "object",
            "oneOf" : [
                { "$ref" : "#/definitions/Null"         },
                { "$ref" : "#/definitions/PublicKey"    },
                { "$ref" : "#/definitions/SharedSecret" }
            ]
        },
        
        "Null" : {
            "type"       : "object",
            "properties" : {
                "type" : { "enum" : [ "Null" ] }
            }
            "requiredProperties"   : [ "type" ],
            "additionalProperties" : false
        },
        
        "PublicKey" : {
            "type"       : "object",
            "properties" : {
                "type" : { "enum" : [ "Public Key" ] }
            }
            "requiredProperties"   : [ "type" ],
            "additionalProperties" : false
        },
        
        "SharedSecret" : {
            "type"       : "object",
            "properties" : {
                "type" : { "enum" : [ "Shared Secret" ] }
            }
            "requiredProperties"   : [ "type" ],
            "additionalProperties" : false
        }
    }
}
